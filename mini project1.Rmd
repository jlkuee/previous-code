---
title: "Mini project1"
author: "Yiyun Sun"
output:
  widescreen: yes
  ioslides_presentation: default
  beamer_presentation: default
---
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(xtable) 
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
data <- read.csv("/Users/sunyiyun/Downloads/body_fat_complete.csv", header=T)
```

<div class="blue2">
## Introduction
</div>
The researcher provided the information on percent body fat and 14 possible predictor variables with 250 observations before. In this project, I'm aim to find a linear regression model where predictor variables and percent body fat shows a strong linear relationship.This model needs to be useful to predict new patients' percent body fat as well. 

## Data
I mainly used the 'body_fat_complete' data to solve these problems, but I only chose 30 obervations as a sample in this project.  
```{r, echo=FALSE, message=FALSE, warning=FALSE}
set.seed(1004728654)
rows <- sample(1:250, 30, replace=FALSE) 
body_fat <- data[rows,]
str(body_fat)
summary(body_fat)
```



```{r}
mcor <- round(cor(body_fat[,1:15]), 2)
mcor
upper <- mcor
upper[upper.tri(mcor)] <- ""   # cells in upper triangle of matrix are deleted
upper <- as.data.frame(upper) # save it as a data frame (easier to work with)
upper
```


```{r}
pairs(body_fat[,1:9], lower.panel=NULL)
```

```{r}
model <- lm(Pct.BF ~ Abdomen, data = body_fat)
summary(model)
plot(body_fat$Pct.BF ~ body_fat$Abdomen, main="Production time vs Size", xlab="age", 
     ylab = "Time for production (minutes)")
abline(a = model$coefficients[1], b = model$coefficients[2], col="red")
```

